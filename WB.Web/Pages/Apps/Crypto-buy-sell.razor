@page "/crypto-buy_sell"
@using Soenneker.Blazor.TomSelect
@using Soenneker.Blazor.TomSelect.Configuration
@using Soenneker.Blazor.TomSelect.Enums
@using ApexCharts

<div class="container-fluid">

    <!-- Page Header -->
    <div class="d-md-flex d-block align-items-center justify-content-between my-4 page-header-breadcrumb">
        <h1 class="page-title fw-semibold fs-18 mb-0">Buy & Sell</h1>
        <div class="ms-md-1 ms-0">
            <nav>
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a href="javascript:void(0);">Crypto</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Buy & Sell</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- Page Header Close -->

    <div class="container">
        <!-- Start::row-1 -->
        <div class="row">
            <div class="col-xl-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">
                            Buy Crypto
                        </div>
                    </div>
                    <div class="card-body">
                        <div>
                            <div class="input-group mb-3 flex-nowrap">
                                <input type="text" class="form-control w-sm-50" aria-label="crypto buy select" placeholder="Select Currency">
                                    @if (isRendered)
                                    {
                                        <TomSelect TItem="SelectItem" Items="_selectedItems" TType="string" Multiple="false" @bind-Value="_selectedValue" Data="_options" TextField="@(item => item.Name)" ValueField="@(item => item.Id)" Placeholder="Select" Configuration="_configuration" />
                                    }
                            </div>
                            <div class="input-group mb-3 flex-nowrap">
                                <input type="text" class="form-control w-sm-50" aria-label="crypto buy select">
                                @if (isRendered)
                                {
                                    <TomSelect TItem="SelectItem" Items="_selectedItems2" TType="string" Multiple="false" @bind-Value="_selectedValue" Data="_options2" TextField="@(item => item.Name)" ValueField="@(item => item.Id)" Placeholder="Select" Configuration="_configuration" />
                                }
                            </div>
                            <div>
                                <div class="fs-14 py-2"><span class="fw-semibold text-dark">Price:</span><span
                                        class="text-muted ms-2 fs-14 d-inline-block">6.003435</span><span
                                        class="text-dark fw-semibold float-end">BTC</span></div>
                                <div class="fs-14 py-2"><span class="fw-semibold text-dark">Amount:</span><span
                                        class="text-muted ms-2 fs-14 d-inline-block">2,34,4543.00</span><span
                                        class="text-dark fw-semibold float-end">LTC</span></div>
                                <div class="fw-semibold fs-14 py-2">Total: <span class="fs-14 d-inline-block">22.00
                                        BTC</span></div>
                                <div class="fs-12 text-success">Additional Charges: 0.32%(0.0001231 BTC)</div>
                                <label class="fw-semibold fs-12 mt-4 mb-2">SELECT PAYMENT METHOD :</label>
                                <div class="row g-2">
                                    <div class="col-xl-6">
                                        <div class="p-2 border rounded">
                                            <div class="form-check mb-0">
                                                <input class="form-check-input" type="radio" name="flexRadioDefault"
                                                    id="flexRadioDefault1" checked>
                                                <label class="form-check-label fs-12" for="flexRadioDefault1">
                                                    Credit / Debit Cards
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="p-2 border rounded">
                                            <div class="form-check mb-0">
                                                <input class="form-check-input" type="radio" name="flexRadioDefault"
                                                    id="flexRadioDefault2">
                                                <label class="form-check-label fs-12" for="flexRadioDefault2">
                                                    Paypal
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-12">
                                        <div class="p-2 border rounded">
                                            <div class="form-check mb-0">
                                                <input class="form-check-input" type="radio" name="flexRadioDefault"
                                                    id="flexRadioDefault3">
                                                <label class="form-check-label fs-12" for="flexRadioDefault3">
                                                    Wallet
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-grid mt-4 pt-1">
                                <button type="button" class="btn btn-primary btn-wave btn-lg">BUY</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">
                            Sell Crypto
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-pane border-0 p-0" id="sell-crypto1" role="tabpanel"
                            aria-labelledby="sell-crypto1">
                            <div class="input-group mb-3 flex-nowrap">
                                <input type="text" class="form-control w-sm-50" aria-label="crypto buy select" placeholder="Select Currency">
                                @if (isRendered)
                                {
                                    <TomSelect TItem="SelectItem" Items="_selectedItems3" TType="string" Multiple="false" @bind-Value="_selectedValue" Data="_options3" TextField="@(item => item.Name)" ValueField="@(item => item.Id)" Placeholder="Select" Configuration="_configuration" />
                                }
                            </div>
                            <div class="input-group mb-3 flex-nowrap">
                                <input type="text" class="form-control w-sm-50" aria-label="crypto buy select">
                                @if (isRendered)
                                {
                                    <TomSelect TItem="SelectItem" Items="_selectedItems4" TType="string" Multiple="false" @bind-Value="_selectedValue" Data="_options4" TextField="@(item => item.Name)" ValueField="@(item => item.Id)" Placeholder="Select" Configuration="_configuration" />
                                }
                            </div>
                            <div class="mb-3">
                                <span class="form-label">Crypto Value :</span>
                                <div class="position-relative">
                                    <div
                                        class="p-2 border rounded d-flex align-items-center justify-content-between gap-3 mt-1">
                                        <div class="gap-2 d-flex align-items-center">
                                            <div class="lh-1">
                                                <span class="avatar bg-light p-2">
                                                    <img src="../assets/images/crypto-currencies/regular/Bitcoin.svg"
                                                        alt="">
                                                </span>
                                            </div>
                                            <div class="fw-semibold">Bitcoin - BTC</div>
                                        </div>
                                        <div class="text-end">
                                            <span class="fw-semibold d-block">0.374638535 BTC</span>
                                            <span class="text-muted">$5,364.65</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <span class="form-label">Deposit To :</span>
                                <div class="position-relative">
                                    <div class="p-2 border rounded d-flex align-items-center gap-2 mt-1">
                                        <div class="lh-1">
                                            <span class="avatar bg-light p-2">
                                                <i class="ri-bank-line text-info fs-20"></i>
                                            </span>
                                        </div>
                                        <div>
                                            <span class="fw-semibold d-block">Banking</span>
                                            <span class="text-muted">Checking ...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="fs-14 py-2">
                                    <div class="d-inline-flex">
                                        <span class="fw-semibold text-dark">Price:</span><span
                                            class="text-muted ms-2 fs-14">6.003435</span>
                                    </div>
                                    <span class="text-dark fw-semibold float-end">BTC</span>
                                </div>
                                <div class="fs-14 py-2">
                                    <div class="d-inline-flex">
                                        <span class="fw-semibold text-dark">Amount:</span><span
                                            class="text-muted ms-2 fs-14">2,34,4543.00</span>
                                    </div>
                                    <span class="text-dark fw-semibold float-end">LTC</span>
                                </div>
                            </div>
                            <div class="d-grid mt-4">
                                <button type="button" class="btn btn-danger btn-wave btn-lg">SELL</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">
                            Quick Secure Transfer
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-pane border-0 p-0" id="sell-crypto" role="tabpanel"
                            aria-labelledby="sell-crypto">
                            <div class="mb-3">
                                <span class="form-label">Crypto Value :</span>
                                <div class="position-relative">
                                    <a href="javascript:void(0);" class="stretched-link"></a>
                                    <div
                                        class="p-2 border rounded d-flex align-items-center justify-content-between gap-3 mt-1">
                                        <div class="gap-2 d-flex align-items-center">
                                            <div class="lh-1">
                                                <span class="avatar bg-light p-2">
                                                    <img src="../assets/images/crypto-currencies/regular/Bitcoin.svg"
                                                        alt="">
                                                </span>
                                            </div>
                                            <div class="fw-semibold">Bitcoin - BTC</div>
                                        </div>
                                        <div class="text-end">
                                            <span class="fw-semibold d-block">0.374638535 BTC</span>
                                            <span class="text-muted">$5,364.65</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <span class="form-label">Deposit To :</span>
                                <div class="position-relative">
                                    <a href="javascript:void(0);" class="stretched-link"></a>
                                    <div class="p-2 border rounded d-flex align-items-center gap-2 mt-1">
                                        <div class="lh-1">
                                            <span class="avatar bg-light p-2">
                                                <i class="ri-bank-line text-info fs-20"></i>
                                            </span>
                                        </div>
                                        <div>
                                            <span class="fw-semibold d-block">Banking</span>
                                            <span class="text-muted">Checking ...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <span class="d-block fw-semibold">Amount :</span>
                                <div class="d-flex align-items-center justify-content-between text-muted">
                                    <div>Weekly Bank Limit</div>
                                    <div>$10,000 remaining</div>
                                </div>
                            </div>
                            <div class="input-group mb-3 flex-nowrap">
                                <input type="text" class="form-control w-sm-50" aria-label="crypto buy select">
                                @if (isRendered)
                                {
                                    <TomSelect TItem="SelectItem" Items="_selectedItems5" TType="string" Multiple="false" @bind-Value="_selectedValue" Data="_options5" TextField="@(item => item.Name)" ValueField="@(item => item.Id)" Placeholder="Select" Configuration="_configuration" />
                                }
                            </div>
                            <div>
                                <div class="fs-14 py-2">
                                    <div class="d-inline-flex">
                                        <span class="fw-semibold text-dark">Price:</span><span
                                            class="text-muted ms-2 fs-14">6.003435</span>
                                    </div>
                                    <span class="text-dark fw-semibold float-end">BTC</span>
                                </div>
                                <div class="fs-14 py-2">
                                    <div class="d-inline-flex">
                                        <span class="fw-semibold text-dark">Amount:</span><span
                                            class="text-muted ms-2 fs-14">2,34,4543.00</span>
                                    </div>
                                    <span class="text-dark fw-semibold float-end">LTC</span>
                                </div>
                            </div>
                            <div class="d-grid mt-4">
                                <button type="button" class="btn btn-success btn-wave btn-lg">Transfer</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End::row-1 -->

        <!-- Start:: row-2 -->
        <div class="row">
            <div class="col-xl-12">
                <div class="card custom-card">
                    <div class="card-header justify-content-between">
                        <div class="card-title">
                            Buy & Sell Statistics
                        </div>
                        <div class="btn-group flex-wrap" role="group" aria-label="Basic example">
                            <button type="button" class="btn btn-primary btn-sm btn-wave">1D</button>
                            <button type="button" class="btn btn-primary-light btn-sm btn-wave">1W</button>
                            <button type="button" class="btn btn-primary-light btn-sm btn-wave">1M</button>
                            <button type="button" class="btn btn-primary-light btn-sm btn-wave">3M</button>
                            <button type="button" class="btn btn-primary-light btn-sm btn-wave">6M</button>
                            <button type="button" class="btn btn-primary-light btn-sm btn-wave">1Y</button>
                        </div>
                    </div>
                    <div class="card-body p-xl-0">
                        <div class="row">
                            <div class="col-xl-8 pe-0 border-end border-inline-end-dashed">
                                <div
                                    class="d-flex flex-wrap align-items-center border-bottom border-block-end-dashed mb-3 p-3 gap-4 ps-5">
                                    <div>
                                        <span class="d-block fs-12">Total Buy</span>
                                        <span class="d-block fw-semibold fs-15 text-success">$324.25 USD</span>
                                    </div>
                                    <div>
                                        <span class="d-block fs-12">Total Sell</span>
                                        <span class="d-block fw-semibold fs-15 text-danger">$4,235.25 USD</span>
                                    </div>
                                    <div>
                                        <span class="d-block fs-12">Available Balance</span>
                                        <span class="d-block fw-semibold fs-15 text-primary">$22,803.92 USD</span>
                                    </div>
                                    <div>
                                        <span class="d-block fs-12">Total Crypto Asset Value</span>
                                        <span class="d-block fw-semibold fs-15 text-warning">$4,56,683.00 USD</span>
                                    </div>
                                    <div></div>
                                </div>
                                <div id="buysellstatistics" class="px-3">
                                    <ApexChart TItem="Buy_sell_statistics" Height="300"
                                        Options=buysellstatisticsChartOptions>
                                        <ApexPointSeries TItem="Buy_sell_statistics" Items="buysellstatistics"
                                            SeriesType="@SeriesType.Line" Name="Buy" Color="rgb(38, 191, 148)"
                                            XValue="@(e => e.Month)" YAggregate="@(e => e.Sum(e => e.Buy))"
                                            Stroke="@(new ApexCharts.SeriesStroke {Color = "rgb(38, 191, 148)",  DashSpace = 0, Width = 3 })" />

                                        <ApexPointSeries TItem="Buy_sell_statistics" Items="buysellstatistics"
                                            SeriesType="@SeriesType.Line" Name="Sell" Color="rgba(230, 83, 60, 0.3)"
                                            XValue="@(e => e.Month)" YAggregate="@(e => e.Sum(e => e.Sell))"
                                            Stroke="@(new ApexCharts.SeriesStroke {Color = "rgba(230, 83, 60, 0.3)",  DashSpace = 5, Width = 3 })" />
                                    </ApexChart>

                                </div>
                            </div>
                            <div class="col-xl-4 ps-xl-0">
                                <div class="p-3">
                                    <div class="card custom-card bg-light shadow-none">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <span class="d-block text-muted fs-12 mb-2">BTC/USD</span>
                                                    <span class="fw-semibold h6 mb-0">27.53612</span>
                                                    <span class="text-danger d-block fs-12 mt-1">-0.06%</span>
                                                </div>
                                                <div>
                                                    <span class="avatar avatar-xl avatar-rounded">
                                                        <img src="../assets/images/crypto-currencies/square-color/Bitcoin.svg"
                                                            alt="">
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card custom-card bg-light shadow-none">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <span class="d-block text-muted fs-12 mb-2">ETH/USD</span>
                                                    <span class="fw-semibold h6 mb-0">20.6782</span>
                                                    <span class="text-success d-block fs-12 mt-1">+2.86%</span>
                                                </div>
                                                <div>
                                                    <span class="avatar avatar-xl avatar-rounded">
                                                        <img src="../assets/images/crypto-currencies/square-color/Ethereum.svg"
                                                            alt="">
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card custom-card bg-light shadow-none mb-0">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-between">
                                                <div>
                                                    <span class="d-block text-muted fs-12 mb-2">LTC/USD</span>
                                                    <span class="fw-semibold h6 mb-0">54.2912</span>
                                                    <span class="text-success d-block fs-12 mt-1">+15.93%</span>
                                                </div>
                                                <div>
                                                    <span class="avatar avatar-xl avatar-rounded">
                                                        <img src="../assets/images/crypto-currencies/square-color/Litecoin.svg"
                                                            alt="">
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End:: row-2 -->
    </div>

</div>

@code {
    
    // Buy_sell_statistics Start //
    private List<Buy_sell_statistics> buysellstatistics { get; set; } = statisticsData.Getstatistics();
    private ApexChartOptions<Buy_sell_statistics> buysellstatisticsChartOptions { get; set; } = new();
    public class Buy_sell_statistics
    {
        public string? Month { get; set; }
        public decimal Buy { get; set; }
        public decimal Sell { get; set; }

    };
    public static class statisticsData
    {
        public static List<Buy_sell_statistics> Getstatistics()
        {
            List<Buy_sell_statistics> buysellstatistics = new List<Buy_sell_statistics>
            {
                new Buy_sell_statistics { Month = "Jan", Buy = 20, Sell = 85 },
                new Buy_sell_statistics { Month = "Feb", Buy = 38, Sell = 65 },
                new Buy_sell_statistics { Month = "Mar", Buy = 38, Sell = 75 },
                new Buy_sell_statistics { Month = "Apr", Buy = 72, Sell = 38 },
                new Buy_sell_statistics { Month = "May", Buy = 55, Sell = 85 },
                new Buy_sell_statistics { Month = "Jun", Buy = 63, Sell = 35 },
                new Buy_sell_statistics { Month = "Jul", Buy = 43, Sell = 62 },
                new Buy_sell_statistics { Month = "Aug", Buy = 76, Sell = 40 },
                new Buy_sell_statistics { Month = "Sep", Buy = 55, Sell = 40 },
                new Buy_sell_statistics { Month = "Oct", Buy = 80, Sell = 64 },
                new Buy_sell_statistics { Month = "Nov", Buy = 40, Sell = 50 },
                new Buy_sell_statistics { Month = "Dec", Buy = 80, Sell = 89 },
            };

            return buysellstatistics;
        }
    }
    private TomSelect<SelectItem, string> _selectedValue = default!;
    private List<SelectItem>? _options;    
    private List<SelectItem>? _options2;    
    private List<SelectItem>? _options3;    
    private List<SelectItem>? _options4;    
    private List<SelectItem>? _options5;    
    private List<SelectItem> _selectedItems = new List<SelectItem>();  
    private List<SelectItem> _selectedItems2 = new List<SelectItem>();   
    private List<SelectItem> _selectedItems3 = new List<SelectItem>();   
    private List<SelectItem> _selectedItems4 = new List<SelectItem>();   
    private List<SelectItem> _selectedItems5 = new List<SelectItem>();     
    public class SelectItem
    {
        public string? Id { get; set; }
        public string? Name { get; set; }
        public bool Selected { get; set; }
    }      
    private readonly TomSelectConfiguration _configuration = new()
    {
        Plugins = new List<TomSelectPluginType> { TomSelectPluginType.DropdownInput }
    };
    private bool isRendered = false;  
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            isRendered = true;
            await Task.Delay(0);
            StateHasChanged(); 
        }
    }
    
    protected override void OnInitialized()
    {
        buysellstatisticsChartOptions = new ApexChartOptions<Buy_sell_statistics>
        {
                Chart = new()
                {
                    Toolbar = new ApexCharts.Toolbar
                    {
                        Tools = new Tools { Zoom = false, Zoomin = false, Zoomout = false, Pan = false, Reset = false, Download = true },
                    },
                    DropShadow = new ApexCharts.DropShadow
                    {
                        Enabled = true,
                        Color = "#000",
                        Top = 5,
                        Left = 0,
                        Blur = 3,
                        Opacity = 0.1
                    }
                },
                DataLabels = new DataLabels
                {
                    Enabled = false
                },
                Legend = new Legend
                {
                    Position = ApexCharts.LegendPosition.Top,
                    HorizontalAlign = Align.Center,
                    OffsetX = -15,
                    FontWeight = "bold",
                },
                Grid = new Grid
                {
                    BorderColor = "#f2f6f7",
                },
                Stroke = new Stroke { Curve = Curve.Smooth },
                Yaxis = new List<YAxis>() {
                    new YAxis // Define the first YAxis object
                    {
                        Title= new() {
                            Text = "Statistics",
                            Style = new() {
                                Color = "#adb5be",
                                FontSize = "14px",
                                FontFamily = "poppins, sans-serif",
                                FontWeight = 600,
                                CssClass = "apexcharts-yaxis-label",
                            },
                        },
                        Labels = new YAxisLabels
                        {
                            Formatter = @"function (value) {return '$' + Number(value).toLocaleString();}"
                        },
                        Min = 0,
                        Max = 100,
                        StepSize = 20,
                    }
            },
        };
        
        _options = new List<SelectItem>
        {
            new SelectItem { Id = "1", Name = "BTC" }, 
            new SelectItem { Id = "2", Name = "ETH" }, 
            new SelectItem { Id = "3", Name = "XRP" }, 
            new SelectItem { Id = "4", Name = "DASH" }, 
            new SelectItem { Id = "5", Name = "NEO" }, 
            new SelectItem { Id = "6", Name = "LTC" }, 
            new SelectItem { Id = "7", Name = "BSD" }, 
        };
        _selectedItems = _options.Take(1).ToList();  
        _options2 = new List<SelectItem>
        {
            new SelectItem { Id = "1", Name = "USD" }, 
            new SelectItem { Id = "2", Name = "AED" }, 
            new SelectItem { Id = "3", Name = "AUD" }, 
            new SelectItem { Id = "4", Name = "ARS" }, 
            new SelectItem { Id = "5", Name = "AZN" }, 
            new SelectItem { Id = "6", Name = "BGN" }, 
            new SelectItem { Id = "7", Name = "BRL" }, 
        };
        _selectedItems2 = _options2.Take(1).ToList();  
        _options3 = new List<SelectItem>
        {
            new SelectItem { Id = "1", Name = "BTC" }, 
            new SelectItem { Id = "2", Name = "ETH" }, 
            new SelectItem { Id = "3", Name = "XRP" }, 
            new SelectItem { Id = "4", Name = "DASH" }, 
            new SelectItem { Id = "5", Name = "NEO" }, 
            new SelectItem { Id = "6", Name = "LTC" }, 
            new SelectItem { Id = "7", Name = "BSD" }, 
        };
        _selectedItems3 = _options3.Take(1).ToList();
        _options4 = new List<SelectItem>
        {
            new SelectItem { Id = "1", Name = "USD" }, 
            new SelectItem { Id = "2", Name = "AED" }, 
            new SelectItem { Id = "3", Name = "AUD" }, 
            new SelectItem { Id = "4", Name = "ARS" }, 
            new SelectItem { Id = "5", Name = "AZN" }, 
            new SelectItem { Id = "6", Name = "BGN" }, 
            new SelectItem { Id = "7", Name = "BRL" }, 
        };
        _selectedItems4 = _options4.Take(1).ToList(); 
        _options5 = new List<SelectItem>
        {
            new SelectItem { Id = "1", Name = "USD" }, 
            new SelectItem { Id = "2", Name = "AED" }, 
            new SelectItem { Id = "3", Name = "AUD" }, 
            new SelectItem { Id = "4", Name = "ARS" }, 
            new SelectItem { Id = "5", Name = "AZN" }, 
            new SelectItem { Id = "6", Name = "BGN" }, 
            new SelectItem { Id = "7", Name = "BRL" }, 
        };
        _selectedItems5 = _options5.Take(1).ToList(); 

    }

}
